{
  "optimization_results": {
    "applied": [
      {
        "sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_answer_sheets_exam_student ON answer_sheets(exam_id, student_id);",
        "benefit": 10,
        "size_impact": 2.0
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_status_created ON exams(status, created_at);",
        "benefit": 9,
        "size_impact": 0.5
      },
      {
        "sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_students_student_id ON students(student_id);",
        "benefit": 9,
        "size_impact": 0.4
      },
      {
        "sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_users_username ON users(username);",
        "benefit": 9,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_status_priority ON grading_tasks(status, priority, created_at);",
        "benefit": 9,
        "size_impact": 0.4
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_pending ON grading_tasks(task_type, priority, created_at) WHERE status = 'pending';",
        "benefit": 9,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_grading_status ON answer_sheets(grading_status);",
        "benefit": 8,
        "size_impact": 1.0
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_students_exam_id ON students(exam_id);",
        "benefit": 8,
        "size_impact": 0.8
      },
      {
        "sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_users_email ON users(email);",
        "benefit": 8,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_exam_score ON answer_sheets(exam_id, total_score) WHERE total_score IS NOT NULL;",
        "benefit": 8,
        "size_impact": 1.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_creator_status_date ON exams(created_by, status, created_at);",
        "benefit": 8,
        "size_impact": 0.6
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_students_exam_class_name ON students(exam_id, class_name, name);",
        "benefit": 8,
        "size_impact": 1.0
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_review_pending ON answer_sheets(exam_id, grading_status, updated_at) WHERE needs_review = true AND reviewed_at IS NULL;",
        "benefit": 8,
        "size_impact": 0.3
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_creator_subject ON exams(created_by, subject);",
        "benefit": 7,
        "size_impact": 0.3
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_needs_review ON answer_sheets(needs_review, grading_status) WHERE needs_review = true;",
        "benefit": 7,
        "size_impact": 0.5
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_answer_sheet ON grading_tasks(answer_sheet_id);",
        "benefit": 7,
        "size_impact": 0.3
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_students_name ON students(name);",
        "benefit": 7,
        "size_impact": 0.5
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_total_score ON answer_sheets(total_score) WHERE total_score IS NOT NULL;",
        "benefit": 7,
        "size_impact": 0.8
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_active_recent ON exams(subject, grade, created_at) WHERE is_active = true AND created_at > datetime('now', '-3 months');",
        "benefit": 7,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_active ON exams(is_active) WHERE is_active = true;",
        "benefit": 6,
        "size_impact": 0.1
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_template_usages_template_exam ON template_usages(template_id, exam_id);",
        "benefit": 6,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_students_class_name ON students(class_name);",
        "benefit": 6,
        "size_impact": 0.3
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_exams_created_at ON exams(created_at);",
        "benefit": 6,
        "size_impact": 0.3
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_created_at ON grading_tasks(created_at);",
        "benefit": 6,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_users_active_role_login ON users(is_active, role, last_login) WHERE is_active = true;",
        "benefit": 6,
        "size_impact": 0.2
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_template_usages_user_date ON template_usages(used_by, used_at);",
        "benefit": 5,
        "size_impact": 0.1
      },
      {
        "sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_updated_at ON answer_sheets(updated_at);",
        "benefit": 5,
        "size_impact": 1.0
      }
    ],
    "failed": [],
    "skipped": [],
    "total_time": 0,
    "total_size_impact": 0
  },
  "optimization_report": {
    "timestamp": "2025-08-20T17:05:28.888828",
    "summary": {
      "total_recommendations": 27,
      "high_priority": 13,
      "medium_priority": 14,
      "low_priority": 0,
      "total_estimated_benefit": 199,
      "total_size_impact_mb": 13.8
    },
    "recommendations_by_priority": {
      "high": [
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_exam_student",
          "columns": [
            "exam_id",
            "student_id"
          ],
          "index_type": "btree",
          "is_unique": true,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 10,
          "creation_sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_answer_sheets_exam_student ON answer_sheets(exam_id, student_id);",
          "size_impact_mb": 2.0
        },
        {
          "table_name": "exams",
          "index_name": "idx_exams_status_created",
          "columns": [
            "status",
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 9,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_status_created ON exams(status, created_at);",
          "size_impact_mb": 0.5
        },
        {
          "table_name": "students",
          "index_name": "idx_students_student_id",
          "columns": [
            "student_id"
          ],
          "index_type": "btree",
          "is_unique": true,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 9,
          "creation_sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_students_student_id ON students(student_id);",
          "size_impact_mb": 0.4
        },
        {
          "table_name": "users",
          "index_name": "idx_users_username",
          "columns": [
            "username"
          ],
          "index_type": "btree",
          "is_unique": true,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 9,
          "creation_sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_users_username ON users(username);",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "grading_tasks",
          "index_name": "idx_grading_tasks_status_priority",
          "columns": [
            "status",
            "priority",
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 9,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_status_priority ON grading_tasks(status, priority, created_at);",
          "size_impact_mb": 0.4
        },
        {
          "table_name": "grading_tasks",
          "index_name": "idx_grading_tasks_pending",
          "columns": [
            "task_type",
            "priority",
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "status = 'pending'",
          "estimated_benefit": 9,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_pending ON grading_tasks(task_type, priority, created_at) WHERE status = 'pending';",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_grading_status",
          "columns": [
            "grading_status"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_grading_status ON answer_sheets(grading_status);",
          "size_impact_mb": 1.0
        },
        {
          "table_name": "students",
          "index_name": "idx_students_exam_id",
          "columns": [
            "exam_id"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_students_exam_id ON students(exam_id);",
          "size_impact_mb": 0.8
        },
        {
          "table_name": "users",
          "index_name": "idx_users_email",
          "columns": [
            "email"
          ],
          "index_type": "btree",
          "is_unique": true,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 8,
          "creation_sql": "CREATE UNIQUE INDEX IF NOT EXISTS idx_users_email ON users(email);",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_exam_score",
          "columns": [
            "exam_id",
            "total_score"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "total_score IS NOT NULL",
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_exam_score ON answer_sheets(exam_id, total_score) WHERE total_score IS NOT NULL;",
          "size_impact_mb": 1.2
        },
        {
          "table_name": "exams",
          "index_name": "idx_exams_creator_status_date",
          "columns": [
            "created_by",
            "status",
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_creator_status_date ON exams(created_by, status, created_at);",
          "size_impact_mb": 0.6
        },
        {
          "table_name": "students",
          "index_name": "idx_students_exam_class_name",
          "columns": [
            "exam_id",
            "class_name",
            "name"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_students_exam_class_name ON students(exam_id, class_name, name);",
          "size_impact_mb": 1.0
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_review_pending",
          "columns": [
            "exam_id",
            "grading_status",
            "updated_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "needs_review = true AND reviewed_at IS NULL",
          "estimated_benefit": 8,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_review_pending ON answer_sheets(exam_id, grading_status, updated_at) WHERE needs_review = true AND reviewed_at IS NULL;",
          "size_impact_mb": 0.3
        }
      ],
      "medium": [
        {
          "table_name": "exams",
          "index_name": "idx_exams_creator_subject",
          "columns": [
            "created_by",
            "subject"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_creator_subject ON exams(created_by, subject);",
          "size_impact_mb": 0.3
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_needs_review",
          "columns": [
            "needs_review",
            "grading_status"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "needs_review = true",
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_needs_review ON answer_sheets(needs_review, grading_status) WHERE needs_review = true;",
          "size_impact_mb": 0.5
        },
        {
          "table_name": "grading_tasks",
          "index_name": "idx_grading_tasks_answer_sheet",
          "columns": [
            "answer_sheet_id"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_answer_sheet ON grading_tasks(answer_sheet_id);",
          "size_impact_mb": 0.3
        },
        {
          "table_name": "students",
          "index_name": "idx_students_name",
          "columns": [
            "name"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_students_name ON students(name);",
          "size_impact_mb": 0.5
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_total_score",
          "columns": [
            "total_score"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "total_score IS NOT NULL",
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_total_score ON answer_sheets(total_score) WHERE total_score IS NOT NULL;",
          "size_impact_mb": 0.8
        },
        {
          "table_name": "exams",
          "index_name": "idx_exams_active_recent",
          "columns": [
            "subject",
            "grade",
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "is_active = true AND created_at > datetime('now', '-3 months')",
          "estimated_benefit": 7,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_active_recent ON exams(subject, grade, created_at) WHERE is_active = true AND created_at > datetime('now', '-3 months');",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "exams",
          "index_name": "idx_exams_active",
          "columns": [
            "is_active"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "is_active = true",
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_active ON exams(is_active) WHERE is_active = true;",
          "size_impact_mb": 0.1
        },
        {
          "table_name": "template_usages",
          "index_name": "idx_template_usages_template_exam",
          "columns": [
            "template_id",
            "exam_id"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_template_usages_template_exam ON template_usages(template_id, exam_id);",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "students",
          "index_name": "idx_students_class_name",
          "columns": [
            "class_name"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_students_class_name ON students(class_name);",
          "size_impact_mb": 0.3
        },
        {
          "table_name": "exams",
          "index_name": "idx_exams_created_at",
          "columns": [
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_exams_created_at ON exams(created_at);",
          "size_impact_mb": 0.3
        },
        {
          "table_name": "grading_tasks",
          "index_name": "idx_grading_tasks_created_at",
          "columns": [
            "created_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_grading_tasks_created_at ON grading_tasks(created_at);",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "users",
          "index_name": "idx_users_active_role_login",
          "columns": [
            "is_active",
            "role",
            "last_login"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": true,
          "condition": "is_active = true",
          "estimated_benefit": 6,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_users_active_role_login ON users(is_active, role, last_login) WHERE is_active = true;",
          "size_impact_mb": 0.2
        },
        {
          "table_name": "template_usages",
          "index_name": "idx_template_usages_user_date",
          "columns": [
            "used_by",
            "used_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 5,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_template_usages_user_date ON template_usages(used_by, used_at);",
          "size_impact_mb": 0.1
        },
        {
          "table_name": "answer_sheets",
          "index_name": "idx_answer_sheets_updated_at",
          "columns": [
            "updated_at"
          ],
          "index_type": "btree",
          "is_unique": false,
          "is_partial": false,
          "condition": null,
          "estimated_benefit": 5,
          "creation_sql": "CREATE INDEX IF NOT EXISTS idx_answer_sheets_updated_at ON answer_sheets(updated_at);",
          "size_impact_mb": 1.0
        }
      ],
      "low": []
    },
    "existing_indexes": {
      "exams": [
        {
          "name": "idx_exam_creator_subject",
          "unique": false,
          "origin": "c",
          "columns": [
            "created_by",
            "subject"
          ]
        },
        {
          "name": "idx_exam_status_created",
          "unique": false,
          "origin": "c",
          "columns": [
            "status",
            "created_at"
          ]
        },
        {
          "name": "sqlite_autoindex_exams_1",
          "unique": true,
          "origin": "pk",
          "columns": [
            "id"
          ]
        }
      ],
      "answer_sheets": [
        {
          "name": "idx_answer_score",
          "unique": false,
          "origin": "c",
          "columns": [
            "total_score"
          ]
        },
        {
          "name": "idx_answer_status",
          "unique": false,
          "origin": "c",
          "columns": [
            "grading_status"
          ]
        },
        {
          "name": "idx_answer_exam_student",
          "unique": false,
          "origin": "c",
          "columns": [
            "exam_id",
            "student_id"
          ]
        },
        {
          "name": "idx_answer_review",
          "unique": false,
          "origin": "c",
          "columns": [
            "needs_review",
            "reviewed_at"
          ]
        },
        {
          "name": "sqlite_autoindex_answer_sheets_1",
          "unique": true,
          "origin": "pk",
          "columns": [
            "id"
          ]
        }
      ],
      "students": [
        {
          "name": "idx_student_class_exam",
          "unique": false,
          "origin": "c",
          "columns": [
            "class_name",
            "exam_id"
          ]
        },
        {
          "name": "idx_student_id_exam",
          "unique": false,
          "origin": "c",
          "columns": [
            "student_id",
            "exam_id"
          ]
        },
        {
          "name": "idx_student_name_exam",
          "unique": false,
          "origin": "c",
          "columns": [
            "name",
            "exam_id"
          ]
        },
        {
          "name": "sqlite_autoindex_students_2",
          "unique": true,
          "origin": "u",
          "columns": [
            "student_id"
          ]
        },
        {
          "name": "sqlite_autoindex_students_1",
          "unique": true,
          "origin": "pk",
          "columns": [
            "id"
          ]
        }
      ],
      "users": [
        {
          "name": "idx_user_username",
          "unique": false,
          "origin": "c",
          "columns": [
            "username"
          ]
        },
        {
          "name": "idx_user_active_role",
          "unique": false,
          "origin": "c",
          "columns": [
            "is_active",
            "role"
          ]
        },
        {
          "name": "idx_user_email",
          "unique": false,
          "origin": "c",
          "columns": [
            "email"
          ]
        },
        {
          "name": "sqlite_autoindex_users_3",
          "unique": true,
          "origin": "u",
          "columns": [
            "email"
          ]
        },
        {
          "name": "sqlite_autoindex_users_2",
          "unique": true,
          "origin": "u",
          "columns": [
            "username"
          ]
        },
        {
          "name": "sqlite_autoindex_users_1",
          "unique": true,
          "origin": "pk",
          "columns": [
            "id"
          ]
        }
      ],
      "grading_tasks": [
        {
          "name": "idx_task_created",
          "unique": false,
          "origin": "c",
          "columns": [
            "created_at"
          ]
        },
        {
          "name": "idx_task_status_priority",
          "unique": false,
          "origin": "c",
          "columns": [
            "status",
            "priority"
          ]
        },
        {
          "name": "sqlite_autoindex_grading_tasks_1",
          "unique": true,
          "origin": "pk",
          "columns": [
            "id"
          ]
        }
      ],
      "answer_sheet_templates": [
        {
          "name": "idx_template_name_creator",
          "unique": false,
          "origin": "c",
          "columns": [
            "name",
            "created_by"
          ]
        },
        {
          "name": "idx_template_active",
          "unique": false,
          "origin": "c",
          "columns": [
            "is_active"
          ]
        },
        {
          "name": "idx_template_subject_grade",
          "unique": false,
          "origin": "c",
          "columns": [
            "subject",
            "grade_level"
          ]
        }
      ],
      "template_usages": [
        {
          "name": "idx_usage_user_date",
          "unique": false,
          "origin": "c",
          "columns": [
            "used_by",
            "used_at"
          ]
        },
        {
          "name": "idx_usage_template_exam",
          "unique": false,
          "origin": "c",
          "columns": [
            "template_id",
            "exam_id"
          ]
        }
      ]
    },
    "optimization_strategies_used": [
      "high_frequency_queries",
      "foreign_key_relationships",
      "search_columns",
      "sorting_columns",
      "composite_conditions",
      "partial_indexes"
    ]
  }
}